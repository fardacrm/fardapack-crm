import{_ as O,r as n,s as Q,o as W,c,d as a,b as M,a as d,e as k,w as I,x as X,A as Z,v as ee,t as C,F as q,h as le,T as ae,C as se,U as te,i as oe,k as g,y as ne,l as u,p as ue,u as w,z as re,D as $,g as ie,S as de}from"./index-BYi8rqoe.js";const ve={class:"page-content"},ce={class:"page-header"},pe={class:"filter-item"},me={class:"filter-item"},fe={class:"filter-item"},_e={class:"filter-item"},ge={key:0,class:"loading-message"},ye={key:1,class:"success-message"},he={key:2},ke={class:"name-cell"},Ce={class:"context-menu"},Me=["onClick"],we=["onClick"],Ue=["onClick"],Se=["onClick"],De={key:4,class:"loading-message"},Ye={__name:"CallsView",setup(Ve){const j=ne(),z=["Ù†Ø§Ù…ÙˆÙÙ‚","Ù…ÙˆÙÙ‚","Ø®Ø§Ù…ÙˆØ´","Ø±Ø¯ ØªÙ…Ø§Ø³"],p=n([]),m=n(!0),o=n(null),r=n(!1),U=n(!1),S=n(!1),D=n(!1),i=n(null),Y=n(null),f=n(0),_=n(20),v=n(1),t=n({name_query:"",statuses:[],start:"",end:""}),B=Q(()=>{if(_.value==="all")return p.value;const l=parseInt(_.value),e=(v.value-1)*l,s=e+l;return p.value.slice(e,s)}),A=l=>{_.value=l==="all"?"all":parseInt(l),v.value=1},E=l=>{const e=parseInt(_.value),s=Math.ceil(f.value/e);l>=1&&l<=s&&(v.value=l)},F=(l=null)=>{i.value=l,U.value=!0},b=()=>{U.value=!1,i.value=null},L=async l=>{if(!l){o.value="Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù…Ø´Ø®Øµ Ø§Ø³Øª.";return}i.value=l;try{const e=await g.get(`/users/${l}`);Y.value=e.data,S.value=!0}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± ÙˆØ§Ú©Ø´ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´."}},T=()=>{S.value=!1,Y.value=null,i.value=null,y()},R=l=>{i.value=l,D.value=!0},x=()=>{D.value=!1,i.value=null},N=async l=>{o.value=null,r.value=!1;try{await g.post("/calls",l),r.value=!0,b(),y(),setTimeout(()=>{r.value=!1},3e3)}catch(e){e.response&&e.response.data&&e.response.data.detail?o.value=e.response.data.detail:o.value="Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª ØªÙ…Ø§Ø³.",console.error("Error saving call:",e)}},G=async(l,e)=>{o.value=null,r.value=!1;try{e?await g.put(`/users/${e}`,l):await g.post("/users",l),r.value=!0,T(),setTimeout(()=>{r.value=!1},3e3)}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø±."}},J=async l=>{o.value=null,r.value=!1;try{await g.post("/followups",l),r.value=!0,x(),setTimeout(()=>{r.value=!1},3e3)}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒ."}},y=async()=>{m.value=!0,o.value=null;const l=new URLSearchParams;t.value.name_query&&l.append("name_query",t.value.name_query),t.value.start&&l.append("start",t.value.start),t.value.end&&l.append("end",t.value.end),t.value.statuses.forEach(e=>{l.append("statuses",e)});try{const e=await g.get("/calls",{params:l}),s=e.data.data||e.data;p.value=s.map(P=>({...P,user_id:P.ID_Ú©Ø§Ø±Ø¨Ø±})),f.value=s.length;const h=parseInt(_.value),V=Math.ceil(f.value/h);v.value>V&&(v.value=V>0?V:1)}catch(e){o.value=e.message||"Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³",p.value=[],f.value=0}finally{m.value=!1}},H=()=>{t.value={name_query:"",statuses:[],start:"",end:""},v.value=1,y()},K=l=>{l?j.push({name:"user-profile",params:{id:l}}):o.value="Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù…Ø´Ø®Øµ Ø§Ø³Øª."};return W(y),(l,e)=>(u(),c(q,null,[a("div",ve,[a("div",ce,[e[5]||(e[5]=a("h2",null,"ğŸ“ Ù„ÛŒØ³Øª ØªÙ…Ø§Ø³â€ŒÙ‡Ø§",-1)),a("button",{onClick:e[0]||(e[0]=s=>F()),class:"add-new-button"},"+ Ø«Ø¨Øª ØªÙ…Ø§Ø³ Ø¬Ø¯ÛŒØ¯")]),k(Z,{onFilter:y,onReset:H},{inputs:X(()=>[a("div",pe,[e[6]||(e[6]=a("span",{class:"icon"},"ğŸ”",-1)),I(a("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.name_query=s),type:"text",placeholder:"Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±/Ø´Ø±Ú©Øª..."},null,512),[[ue,t.value.name_query]])]),a("div",me,[e[7]||(e[7]=a("span",{class:"icon"},"ğŸ“Š",-1)),k(w(re),{modelValue:t.value.statuses,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.statuses=s),mode:"tags",placeholder:"Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§",options:z,"close-on-select":!1,class:"multiselect-filter"},null,8,["modelValue"])]),a("div",fe,[e[8]||(e[8]=a("span",{class:"icon"},"ğŸ“…",-1)),k(w($),{modelValue:t.value.start,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.start=s),format:"YYYY-MM-DD","display-format":"jYYYY/jMM/jDD",placeholder:"Ø§Ø² ØªØ§Ø±ÛŒØ®...",class:"datepicker-filter"},null,8,["modelValue"])]),a("div",_e,[e[9]||(e[9]=a("span",{class:"icon"},"ğŸ“…",-1)),k(w($),{modelValue:t.value.end,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.end=s),format:"YYYY-MM-DD","display-format":"jYYYY/jMM/jDD",placeholder:"ØªØ§ ØªØ§Ø±ÛŒØ®...",class:"datepicker-filter"},null,8,["modelValue"])])]),_:1}),m.value?(u(),c("div",ge,"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³â€ŒÙ‡Ø§...")):d("",!0),I(a("div",{class:"error-detail"},"Ø®Ø·Ø§: "+C(o.value),513),[[ee,o.value]]),r.value?(u(),c("div",ye,"ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯!")):d("",!0),p.value.length>0&&!m.value?(u(),c("table",he,[e[10]||(e[10]=a("thead",null,[a("tr",null,[a("th",null,"Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±"),a("th",null,"Ø´Ø±Ú©Øª"),a("th",null,"ØªØ§Ø±ÛŒØ® Ùˆ Ø²Ù…Ø§Ù†"),a("th",null,"ÙˆØ¶Ø¹ÛŒØª"),a("th",null,"Ú©Ø§Ø±Ø´Ù†Ø§Ø³")])],-1)),a("tbody",null,[(u(!0),c(q,null,le(B.value,s=>(u(),c("tr",{key:s.ID},[a("td",ke,[a("span",null,C(s.Ù†Ø§Ù…_Ú©Ø§Ø±Ø¨Ø±),1),a("div",Ce,[a("button",{onClick:h=>K(s.user_id)},"ğŸ‘ Ù†Ù…Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„",8,Me),a("button",{onClick:h=>L(s.user_id)},"âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ø§Ø±Ø¨Ø±",8,we),a("button",{onClick:h=>F(s.user_id)},"ğŸ“ Ø«Ø¨Øª ØªÙ…Ø§Ø³",8,Ue),a("button",{onClick:h=>R(s.user_id)},"ğŸ—“ï¸ Ø«Ø¨Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒ",8,Se)])]),a("td",null,C(s.Ø´Ø±Ú©Øª),1),a("td",null,C(w(ie)(s.ØªØ§Ø±ÛŒØ®_Ùˆ_Ø²Ù…Ø§Ù†)),1),a("td",null,[k(de,{text:s.ÙˆØ¶Ø¹ÛŒØª},null,8,["text"])]),a("td",null,C(s.Ú©Ø§Ø±Ø´Ù†Ø§Ø³_ÙØ±ÙˆØ´),1)]))),128))])])):d("",!0),!m.value&&f.value>0?(u(),M(ae,{key:3,"total-records":f.value,"page-size":_.value,"current-page":v.value,"onUpdate:pageSize":A,onGoToPage:E},null,8,["total-records","page-size","current-page"])):d("",!0),p.value.length===0&&!m.value?(u(),c("p",De," ØªÙ…Ø§Ø³ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯. ")):d("",!0)]),U.value?(u(),M(se,{key:0,preselectedUserId:i.value,onClose:b,onSave:N},null,8,["preselectedUserId"])):d("",!0),S.value?(u(),M(te,{key:1,initialData:Y.value,onClose:T,onSave:G},null,8,["initialData"])):d("",!0),D.value?(u(),M(oe,{key:2,preselectedUserId:i.value,onClose:x,onSave:J},null,8,["preselectedUserId"])):d("",!0)],64))}},be=O(Ye,[["__scopeId","data-v-21bb6a55"]]);export{be as default};
