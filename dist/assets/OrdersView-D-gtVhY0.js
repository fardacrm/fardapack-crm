import{_ as G,r as i,s as R,o as J,B as H,c as r,d as e,t as f,m as j,a as w,w as g,f as N,E as A,p as F,q as O,F as x,h as Y,e as h,u as C,D as K,k as S,l as u,b as Q,x as W,A as X,v as Z,T as ee,z as P,G as le,S as te}from"./index-DNgNiQ0R.js";const ae={class:"modal-box"},se={class:"input-group-full"},oe={class:"radio-group"},ue={key:0,class:"input-group-full"},ne={key:0,value:""},re={key:1,value:"",disabled:""},ie=["value"],de={key:1,class:"input-group-full"},pe={key:0,value:""},ve={key:1,value:"",disabled:""},ce=["value"],me={class:"input-group-full"},fe={key:0,value:""},_e={key:1,value:"",disabled:""},ye=["value"],ge={class:"form-grid"},be={class:"input-group"},De={class:"input-group"},ke={class:"input-group-full"},Ve={__name:"OrderFormModal",props:{initialData:{type:Object,default:null}},emits:["close","save"],setup(z,{emit:B}){const c=z,_=B,V=i(!1),d=i({user_id:null,company_id:null,product_id:null,order_date:new Date().toISOString().split("T")[0],status:"Ø¯Ø± Ø­Ø§Ù„ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ",total_amount:0}),m=i("user"),b=i([]),D=i([]),y=i([]),n=i({users:!1,companies:!1,products:!1}),p=i(""),k=i(""),I=i(""),L=R(()=>{const o=p.value.toLowerCase();return o?b.value.filter(t=>t.Ù†Ø§Ù…_Ú©Ø§Ù…Ù„.toLowerCase().includes(o)):b.value}),T=R(()=>{const o=k.value.toLowerCase();return o?D.value.filter(t=>t.Ù†Ø§Ù…_Ø´Ø±Ú©Øª.toLowerCase().includes(o)):D.value}),M=R(()=>{const o=I.value.toLowerCase();return o?y.value.filter(t=>t.name.toLowerCase().includes(o)||t.category.toLowerCase().includes(o)):y.value}),U=async(o,t,l)=>{n.value[o]=!0;try{const a=await S.get(t);l.value=a.data}catch(a){console.error(`Error fetching ${o}:`,a)}finally{n.value[o]=!1}};J(()=>{U("users","/users",b),U("companies","/companies",D),U("products","/products",y),c.initialData&&(V.value=!0,d.value={user_id:c.initialData.user_id,company_id:c.initialData.company_id,product_id:c.initialData.product_id,order_date:c.initialData.ØªØ§Ø±ÛŒØ®_Ø³ÙØ§Ø±Ø´,status:c.initialData.ÙˆØ¶Ø¹ÛŒØª,total_amount:parseFloat(String(c.initialData.Ù…Ø¨Ù„Øº_Ú©Ù„).replace(/,/g,""))||0},c.initialData.company_id?m.value="company":m.value="user")}),H(m,o=>{o==="user"?d.value.company_id=null:d.value.user_id=null});const q=()=>{_("close")},$=()=>{const o={...d.value};o.user_id=o.user_id?parseInt(o.user_id,10):null,o.company_id=o.company_id?parseInt(o.company_id,10):null,o.product_id=parseInt(o.product_id,10),_("save",o,V.value?c.initialData.ID:null)};return(o,t)=>(u(),r("div",{class:"modal-overlay",onClick:j(q,["self"])},[e("div",ae,[e("h2",null,f(V.value?"ÙˆÛŒØ±Ø§ÛŒØ´ Ø³ÙØ§Ø±Ø´":"Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯"),1),e("form",{onSubmit:j($,["prevent"])},[e("div",se,[t[13]||(t[13]=e("label",null,"Ø³ÙØ§Ø±Ø´ Ø¨Ø±Ø§ÛŒ:",-1)),e("div",oe,[e("label",null,[g(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),value:"user"},null,512),[[A,m.value]]),t[11]||(t[11]=N(" Ú©Ø§Ø±Ø¨Ø±",-1))]),e("label",null,[g(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=l=>m.value=l),value:"company"},null,512),[[A,m.value]]),t[12]||(t[12]=N(" Ø´Ø±Ú©Øª",-1))])])]),m.value==="user"?(u(),r("div",ue,[t[14]||(t[14]=e("label",{for:"user_search"},"Ú©Ø§Ø±Ø¨Ø± (Ù…Ø®Ø§Ø·Ø¨) *",-1)),g(e("input",{id:"user_search","onUpdate:modelValue":t[2]||(t[2]=l=>p.value=l),type:"text",placeholder:"Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±...",class:"search-input"},null,512),[[F,p.value]]),g(e("select",{id:"user_id","onUpdate:modelValue":t[3]||(t[3]=l=>d.value.user_id=l),required:""},[n.value.users?(u(),r("option",ne,"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...")):L.value.length===0?(u(),r("option",re,"Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯")):(u(!0),r(x,{key:2},Y(L.value,l=>(u(),r("option",{key:l.ID,value:l.ID},f(l.Ù†Ø§Ù…_Ú©Ø§Ù…Ù„)+" ("+f(l.Ø´Ø±Ú©Øª||"Ø¨Ø¯ÙˆÙ† Ø´Ø±Ú©Øª")+") ",9,ie))),128))],512),[[O,d.value.user_id]])])):w("",!0),m.value==="company"?(u(),r("div",de,[t[15]||(t[15]=e("label",{for:"company_search"},"Ø´Ø±Ú©Øª *",-1)),g(e("input",{id:"company_search","onUpdate:modelValue":t[4]||(t[4]=l=>k.value=l),type:"text",placeholder:"Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… Ø´Ø±Ú©Øª...",class:"search-input"},null,512),[[F,k.value]]),g(e("select",{id:"company_id","onUpdate:modelValue":t[5]||(t[5]=l=>d.value.company_id=l),required:""},[n.value.companies?(u(),r("option",pe,"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...")):T.value.length===0?(u(),r("option",ve,"Ø´Ø±Ú©ØªÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯")):(u(!0),r(x,{key:2},Y(T.value,l=>(u(),r("option",{key:l.ID,value:l.ID},f(l.Ù†Ø§Ù…_Ø´Ø±Ú©Øª),9,ce))),128))],512),[[O,d.value.company_id]])])):w("",!0),e("div",me,[t[16]||(t[16]=e("label",{for:"product_search"},"Ù…Ø­ØµÙˆÙ„ *",-1)),g(e("input",{id:"product_search","onUpdate:modelValue":t[6]||(t[6]=l=>I.value=l),type:"text",placeholder:"Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„...",class:"search-input"},null,512),[[F,I.value]]),g(e("select",{id:"product_id","onUpdate:modelValue":t[7]||(t[7]=l=>d.value.product_id=l),required:""},[n.value.products?(u(),r("option",fe,"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...")):M.value.length===0?(u(),r("option",_e,"Ù…Ø­ØµÙˆÙ„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯")):(u(!0),r(x,{key:2},Y(M.value,l=>(u(),r("option",{key:l.id,value:l.id},f(l.name)+" ("+f(l.category)+") ",9,ye))),128))],512),[[O,d.value.product_id]])]),e("div",ge,[e("div",be,[t[17]||(t[17]=e("label",{for:"order_date"},"ØªØ§Ø±ÛŒØ® Ø³ÙØ§Ø±Ø´ *",-1)),h(C(K),{id:"order_date",modelValue:d.value.order_date,"onUpdate:modelValue":t[8]||(t[8]=l=>d.value.order_date=l),format:"YYYY-MM-DD","display-format":"jYYYY/jMM/jDD",required:"",class:"custom-datepicker"},null,8,["modelValue"])]),e("div",De,[t[18]||(t[18]=e("label",{for:"total_amount"},"Ù…Ø¨Ù„Øº Ú©Ù„ *",-1)),g(e("input",{id:"total_amount","onUpdate:modelValue":t[9]||(t[9]=l=>d.value.total_amount=l),type:"number",min:"0",required:""},null,512),[[F,d.value.total_amount,void 0,{number:!0}]])])]),e("div",ke,[t[20]||(t[20]=e("label",{for:"status"},"ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´ *",-1)),g(e("select",{id:"status","onUpdate:modelValue":t[10]||(t[10]=l=>d.value.status=l),required:""},[...t[19]||(t[19]=[e("option",null,"Ø¯Ø± Ø­Ø§Ù„ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ",-1),e("option",null,"ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡",-1),e("option",null,"Ú©Ù†Ø³Ù„ Ø´Ø¯Ù‡",-1),e("option",null,"Ø±Ø¯ Ø´Ø¯Ù‡",-1)])],512),[[O,d.value.status]])]),e("div",{class:"modal-actions"},[e("button",{type:"button",class:"btn-cancel",onClick:q},"Ù„ØºÙˆ"),t[21]||(t[21]=e("button",{type:"submit",class:"btn-save"},"Ø°Ø®ÛŒØ±Ù‡",-1))])],32)])]))}},we=G(Ve,[["__scopeId","data-v-8eff9111"]]),he={class:"page-content"},Se={class:"page-header"},Ue={class:"filter-item"},$e={class:"filter-item"},Ce={class:"filter-item"},Ie={class:"filter-item"},Me={key:0,class:"loading-message"},xe={key:1,class:"success-message"},Le={key:2},Te=["onClick"],qe={key:4,class:"loading-message"},Fe={__name:"OrdersView",setup(z){const B=["Ø¯Ø± Ø­Ø§Ù„ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ","ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡","Ú©Ù†Ø³Ù„ Ø´Ø¯Ù‡","Ø±Ø¯ Ø´Ø¯Ù‡"],c=i([]),_=i(null),V=i(!1),d=i(!1),m=i(null),b=i(0),D=i(20),y=i(1),n=i({user_filter:null,company_filter:null,product_filter:null,status_filter:null}),p=i({orders:!0,users:!1,companies:!1,products:!1}),k=i({users:[],companies:[],products:[]}),I=R(()=>{if(D.value==="all")return c.value;const l=parseInt(D.value),a=(y.value-1)*l,s=a+l;return c.value.slice(a,s)}),L=l=>{D.value=l==="all"?"all":parseInt(l),y.value=1},T=l=>{const a=parseInt(D.value),s=Math.ceil(b.value/a);l>=1&&l<=s&&(y.value=l)},M=(l=null)=>{m.value=l,d.value=!0},U=()=>{d.value=!1,m.value=null},q=async(l,a)=>{_.value=null,V.value=!1;const s={...l};try{a?await S.put(`/orders/${a}`,s):await S.post("/orders",s),V.value=!0,U(),$(),setTimeout(()=>{V.value=!1},3e3)}catch(v){v.response&&v.response.data&&v.response.data.detail?_.value=v.response.data.detail:_.value="Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø³ÙØ§Ø±Ø´."}},$=async()=>{p.value.orders=!0,_.value=null;const l={};n.value.user_filter&&(l.user_filter=n.value.user_filter),n.value.company_filter&&(l.company_filter=n.value.company_filter),n.value.product_filter&&(l.product_filter=n.value.product_filter),n.value.status_filter&&(l.status_filter=n.value.status_filter);try{const a=await S.get("/orders",{params:l}),s=a.data.data||a.data;c.value=s,b.value=s.length;const v=parseInt(D.value),E=Math.ceil(b.value/v);y.value>E&&(y.value=E>0?E:1)}catch(a){_.value=a.message||"Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³",c.value=[],b.value=0}finally{p.value.orders=!1}},o=async()=>{p.value.users=!0,p.value.companies=!0,p.value.products=!0;try{const[l,a,s]=await Promise.all([S.get("/users"),S.get("/companies"),S.get("/products")]);k.value.users=l.data.map(v=>({value:v.ID,label:v.Ù†Ø§Ù…_Ú©Ø§Ù…Ù„})),k.value.companies=a.data.map(v=>({value:v.ID,label:v.Ù†Ø§Ù…_Ø´Ø±Ú©Øª})),k.value.products=s.data.map(v=>({value:v.id,label:`${v.name} (${v.category})`}))}catch{_.value="Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙÛŒÙ„ØªØ±"}finally{p.value.users=!1,p.value.companies=!1,p.value.products=!1}},t=()=>{n.value={user_filter:null,company_filter:null,product_filter:null,status_filter:null},y.value=1,$()};return J(()=>{$(),o()}),(l,a)=>(u(),r(x,null,[e("div",he,[e("div",Se,[a[5]||(a[5]=e("h2",null,"ğŸ›’ Ù„ÛŒØ³Øª Ø³ÙØ§Ø±Ø´Ø§Øª",-1)),e("button",{onClick:a[0]||(a[0]=s=>M()),class:"add-new-button"},"+ Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯")]),h(X,{onFilter:$,onReset:t},{inputs:W(()=>[e("div",Ue,[a[6]||(a[6]=e("span",{class:"icon"},"ğŸ‘¤",-1)),h(C(P),{modelValue:n.value.user_filter,"onUpdate:modelValue":a[1]||(a[1]=s=>n.value.user_filter=s),placeholder:"Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø§Ø±Ø¨Ø±",options:k.value.users,searchable:!0,loading:p.value.users,class:"multiselect-filter"},null,8,["modelValue","options","loading"])]),e("div",$e,[a[7]||(a[7]=e("span",{class:"icon"},"ğŸ¢",-1)),h(C(P),{modelValue:n.value.company_filter,"onUpdate:modelValue":a[2]||(a[2]=s=>n.value.company_filter=s),placeholder:"Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø±Ú©Øª",options:k.value.companies,searchable:!0,loading:p.value.companies,class:"multiselect-filter"},null,8,["modelValue","options","loading"])]),e("div",Ce,[a[8]||(a[8]=e("span",{class:"icon"},"ğŸ“¦",-1)),h(C(P),{modelValue:n.value.product_filter,"onUpdate:modelValue":a[3]||(a[3]=s=>n.value.product_filter=s),placeholder:"Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø­ØµÙˆÙ„",options:k.value.products,searchable:!0,loading:p.value.products,class:"multiselect-filter"},null,8,["modelValue","options","loading"])]),e("div",Ie,[a[9]||(a[9]=e("span",{class:"icon"},"ğŸ“Š",-1)),h(C(P),{modelValue:n.value.status_filter,"onUpdate:modelValue":a[4]||(a[4]=s=>n.value.status_filter=s),placeholder:"Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ¶Ø¹ÛŒØª",options:B,class:"multiselect-filter"},null,8,["modelValue"])])]),_:1}),p.value.orders?(u(),r("div",Me,"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙØ§Ø±Ø´Ø§Øª...")):w("",!0),g(e("div",{class:"error-detail"},"Ø®Ø·Ø§: "+f(_.value),513),[[Z,_.value]]),V.value?(u(),r("div",xe,"Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!")):w("",!0),c.value.length>0&&!p.value.orders?(u(),r("table",Le,[a[10]||(a[10]=e("thead",null,[e("tr",null,[e("th",null,"Ù…Ø´ØªØ±ÛŒ (Ú©Ø§Ø±Ø¨Ø±/Ø´Ø±Ú©Øª)"),e("th",null,"Ù…Ø­ØµÙˆÙ„"),e("th",null,"ØªØ§Ø±ÛŒØ® Ø³ÙØ§Ø±Ø´"),e("th",null,"Ù…Ø¨Ù„Øº Ú©Ù„"),e("th",null,"ÙˆØ¶Ø¹ÛŒØª"),e("th",null,"Ø¹Ù…Ù„ÛŒØ§Øª")])],-1)),e("tbody",null,[(u(!0),r(x,null,Y(I.value,s=>(u(),r("tr",{key:s.ID},[e("td",null,f(s.Ú©Ø§Ø±Ø¨Ø±!=="â€”"?s.Ú©Ø§Ø±Ø¨Ø±:s.Ø´Ø±Ú©Øª),1),e("td",null,f(s.Ù…Ø­ØµÙˆÙ„)+" ("+f(s.Ø¯Ø³ØªÙ‡_Ø¨Ù†Ø¯ÛŒ)+")",1),e("td",null,f(C(le)(s.ØªØ§Ø±ÛŒØ®_Ø³ÙØ§Ø±Ø´)),1),e("td",null,f(s.Ù…Ø¨Ù„Øº_Ú©Ù„),1),e("td",null,[h(te,{text:s.ÙˆØ¶Ø¹ÛŒØª},null,8,["text"])]),e("td",null,[e("button",{onClick:v=>M(s),class:"btn-edit"},"âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´",8,Te)])]))),128))])])):w("",!0),!p.value.orders&&b.value>0?(u(),Q(ee,{key:3,"total-records":b.value,"page-size":D.value,"current-page":y.value,"onUpdate:pageSize":L,onGoToPage:T},null,8,["total-records","page-size","current-page"])):w("",!0),c.value.length===0&&!p.value.orders?(u(),r("p",qe," Ø³ÙØ§Ø±Ø´ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯. ")):w("",!0)]),d.value?(u(),Q(we,{key:0,initialData:m.value,onClose:U,onSave:q},null,8,["initialData"])):w("",!0)],64))}},Pe=G(Fe,[["__scopeId","data-v-73c05159"]]);export{Pe as default};
