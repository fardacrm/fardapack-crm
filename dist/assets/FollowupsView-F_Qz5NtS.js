import{_ as W,r as n,s as X,o as Z,c as p,d as a,b as C,a as c,e as M,w as D,x as ee,A as le,v as ae,t as y,F as x,h as se,T as te,i as oe,U as ue,C as ne,k as m,y as re,l as r,p as de,u as U,z as ie,D as $,g as ce,q as ve,n as pe}from"./index-BYi8rqoe.js";const me={class:"page-content"},fe={class:"page-header"},_e={class:"filter-item"},ge={class:"filter-item"},he={class:"filter-item"},ye={class:"filter-item"},we={key:0,class:"loading-message"},Ce={key:1,class:"success-message"},Me={key:2},Ue={class:"name-cell"},Se={class:"context-menu"},Fe=["onClick"],Ve=["onClick"],Ye=["onClick"],De=["onClick"],Te=["onUpdate:modelValue","onChange"],ke={key:4,class:"loading-message"},Ie={__name:"FollowupsView",setup(be){const j=re(),z=["Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…","Ù¾Ø§ÛŒØ§Ù† ÛŒØ§ÙØªÙ‡"],f=n([]),_=n(!0),o=n(null),u=n(!1),g=n(0),h=n(20),v=n(1),S=n(!1),F=n(!1),V=n(!1),d=n(null),T=n(null),t=n({name_query:"",statuses:[],start:"",end:""}),A=X(()=>{if(h.value==="all")return f.value;const l=parseInt(h.value),e=(v.value-1)*l,s=e+l;return f.value.slice(e,s)}),B=l=>{h.value=l==="all"?"all":parseInt(l),v.value=1},E=l=>{const e=parseInt(h.value),s=Math.ceil(g.value/e);l>=1&&l<=s&&(v.value=l)},k=(l=null)=>{d.value=l,S.value=!0},I=()=>{S.value=!1,d.value=null},R=async l=>{if(l){d.value=l;try{const e=await m.get(`/users/${l}`);T.value=e.data,F.value=!0}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± ÙˆØ§Ú©Ø´ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´."}}},b=()=>{F.value=!1,T.value=null,d.value=null},N=l=>{d.value=l,V.value=!0},P=()=>{V.value=!1,d.value=null},L=async l=>{o.value=null,u.value=!1;try{await m.post("/followups",l),u.value=!0,I(),w(),setTimeout(()=>{u.value=!1},3e3)}catch(e){e.response&&e.response.data&&e.response.data.detail?o.value=e.response.data.detail:o.value="Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒ.",console.error("Error saving followup:",e)}},G=async(l,e)=>{o.value=null,u.value=!1;try{e?await m.put(`/users/${e}`,l):await m.post("/users",l),u.value=!0,b(),setTimeout(()=>{u.value=!1},3e3)}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø±."}},J=async l=>{o.value=null,u.value=!1;try{await m.post("/calls",l),u.value=!0,P(),setTimeout(()=>{u.value=!1},3e3)}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª ØªÙ…Ø§Ø³."}},w=async()=>{_.value=!0,o.value=null;const l=new URLSearchParams;t.value.name_query&&l.append("name_query",t.value.name_query),t.value.start&&l.append("start",t.value.start),t.value.end&&l.append("end",t.value.end),t.value.statuses.forEach(e=>{l.append("statuses",e)});try{const e=await m.get("/followups",{params:l}),s=e.data.data||e.data;f.value=s.map(q=>({...q,user_id:q.ID_Ú©Ø§Ø±Ø¨Ø±})),g.value=s.length;const i=parseInt(h.value),Y=Math.ceil(g.value/i);v.value>Y&&(v.value=Y>0?Y:1)}catch(e){o.value=e.message||"Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³",f.value=[],g.value=0}finally{_.value=!1}},K=async(l,e)=>{o.value=null,u.value=!1;try{await m.put(`/followups/${l}/status`,{status:e}),u.value=!0,setTimeout(()=>{u.value=!1},2e3)}catch{o.value="Ø®Ø·Ø§ Ø¯Ø± Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª.",w()}},H=l=>l==="Ù¾Ø§ÛŒØ§Ù† ÛŒØ§ÙØªÙ‡"?"status-green":"status-orange",O=()=>{t.value={name_query:"",statuses:[],start:"",end:""},v.value=1,w()},Q=l=>{l?j.push({name:"user-profile",params:{id:l}}):o.value="Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù…Ø´Ø®Øµ Ø§Ø³Øª."};return Z(w),(l,e)=>(r(),p(x,null,[a("div",me,[a("div",fe,[e[5]||(e[5]=a("h2",null,"ğŸ—“ï¸ Ù„ÛŒØ³Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§",-1)),a("button",{onClick:e[0]||(e[0]=s=>k()),class:"add-new-button"},"+ Ø«Ø¨Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø¬Ø¯ÛŒØ¯")]),M(le,{onFilter:w,onReset:O},{inputs:ee(()=>[a("div",_e,[e[6]||(e[6]=a("span",{class:"icon"},"ğŸ”",-1)),D(a("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.value.name_query=s),type:"text",placeholder:"Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±/Ø´Ø±Ú©Øª..."},null,512),[[de,t.value.name_query]])]),a("div",ge,[e[7]||(e[7]=a("span",{class:"icon"},"ğŸ“Š",-1)),M(U(ie),{modelValue:t.value.statuses,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.statuses=s),mode:"tags",placeholder:"Ø§Ù†ØªØ®Ø§Ø¨ ÙˆØ¶Ø¹ÛŒØªâ€ŒÙ‡Ø§",options:z,"close-on-select":!1,class:"multiselect-filter"},null,8,["modelValue"])]),a("div",he,[e[8]||(e[8]=a("span",{class:"icon"},"ğŸ“…",-1)),M(U($),{modelValue:t.value.start,"onUpdate:modelValue":e[3]||(e[3]=s=>t.value.start=s),format:"YYYY-MM-DD","display-format":"jYYYY/jMM/jDD",placeholder:"Ø§Ø² ØªØ§Ø±ÛŒØ® Ù¾ÛŒÚ¯ÛŒØ±ÛŒ...",class:"datepicker-filter"},null,8,["modelValue"])]),a("div",ye,[e[9]||(e[9]=a("span",{class:"icon"},"ğŸ“…",-1)),M(U($),{modelValue:t.value.end,"onUpdate:modelValue":e[4]||(e[4]=s=>t.value.end=s),format:"YYYY-MM-DD","display-format":"jYYYY/jMM/jDD",placeholder:"ØªØ§ ØªØ§Ø±ÛŒØ® Ù¾ÛŒÚ¯ÛŒØ±ÛŒ...",class:"datepicker-filter"},null,8,["modelValue"])])]),_:1}),_.value?(r(),p("div",we,"Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§...")):c("",!0),D(a("div",{class:"error-detail"},"Ø®Ø·Ø§: "+y(o.value),513),[[ae,o.value]]),u.value?(r(),p("div",Ce,"Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!")):c("",!0),f.value.length>0&&!_.value?(r(),p("table",Me,[e[11]||(e[11]=a("thead",null,[a("tr",null,[a("th",null,"Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±"),a("th",null,"Ø¹Ù†ÙˆØ§Ù†"),a("th",null,"Ø´Ø±Ú©Øª"),a("th",null,"ØªØ§Ø±ÛŒØ® Ù¾ÛŒÚ¯ÛŒØ±ÛŒ"),a("th",null,"ÙˆØ¶Ø¹ÛŒØª"),a("th",null,"Ú©Ø§Ø±Ø´Ù†Ø§Ø³")])],-1)),a("tbody",null,[(r(!0),p(x,null,se(A.value,s=>(r(),p("tr",{key:s.ID},[a("td",Ue,[a("span",null,y(s.Ù†Ø§Ù…_Ú©Ø§Ø±Ø¨Ø±),1),a("div",Se,[a("button",{onClick:i=>Q(s.user_id)},"ğŸ‘ Ù†Ù…Ø§ÛŒØ´ Ù¾Ø±ÙˆÙØ§ÛŒÙ„",8,Fe),a("button",{onClick:i=>R(s.user_id)},"âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ø§Ø±Ø¨Ø±",8,Ve),a("button",{onClick:i=>N(s.user_id)},"ğŸ“ Ø«Ø¨Øª ØªÙ…Ø§Ø³",8,Ye),a("button",{onClick:i=>k(s.user_id)},"ğŸ—“ï¸ Ø«Ø¨Øª Ù¾ÛŒÚ¯ÛŒØ±ÛŒ",8,De)])]),a("td",null,y(s.Ø¹Ù†ÙˆØ§Ù†),1),a("td",null,y(s.Ø´Ø±Ú©Øª),1),a("td",null,y(U(ce)(s.ØªØ§Ø±ÛŒØ®_Ù¾ÛŒÚ¯ÛŒØ±ÛŒ)),1),a("td",null,[D(a("select",{"onUpdate:modelValue":i=>s.ÙˆØ¶Ø¹ÛŒØª=i,onChange:i=>K(s.ID,i.target.value),class:pe(["status-select",H(s.ÙˆØ¶Ø¹ÛŒØª)])},[...e[10]||(e[10]=[a("option",{value:"Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…"},"Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…",-1),a("option",{value:"Ù¾Ø§ÛŒØ§Ù† ÛŒØ§ÙØªÙ‡"},"Ù¾Ø§ÛŒØ§Ù† ÛŒØ§ÙØªÙ‡",-1)])],42,Te),[[ve,s.ÙˆØ¶Ø¹ÛŒØª]])]),a("td",null,y(s.Ú©Ø§Ø±Ø´Ù†Ø§Ø³_ÙØ±ÙˆØ´),1)]))),128))])])):c("",!0),!_.value&&g.value>0?(r(),C(te,{key:3,"total-records":g.value,"page-size":h.value,"current-page":v.value,"onUpdate:pageSize":B,onGoToPage:E},null,8,["total-records","page-size","current-page"])):c("",!0),f.value.length===0&&!_.value?(r(),p("p",ke," Ù¾ÛŒÚ¯ÛŒØ±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯. ")):c("",!0)]),S.value?(r(),C(oe,{key:0,preselectedUserId:d.value,onClose:I,onSave:L},null,8,["preselectedUserId"])):c("",!0),F.value?(r(),C(ue,{key:1,preselectedUserId:d.value,onClose:b,onSave:G},null,8,["preselectedUserId"])):c("",!0),V.value?(r(),C(ne,{key:2,preselectedUserId:d.value,onClose:P,onSave:J},null,8,["preselectedUserId"])):c("",!0)],64))}},qe=W(Ie,[["__scopeId","data-v-9d39dc9e"]]);export{qe as default};
